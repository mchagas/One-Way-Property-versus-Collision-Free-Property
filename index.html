<!DOCTYPE html>
<html>
  <head>
    <title>Marotice</title>
    <meta charset="utf-8">
  </head>
  <body>
	<script src="md5.min.js"></script>
	<script>

	function cfp(bits){
		var HashesExplored = [];
        var count = 0;

		while(true){
			count++;
			var lengthOfString = parseInt(Math.random() * (26 - 1) + 1);
			var randomMessage = randomString(lengthOfString);
			var duplicateHash = md5(randomMessage);		
			var duplicateHash_nbits = duplicateHash.substr(0, bits);

			for(var i = 0; i < HashesExplored.length; i++){
				var dado = HashesExplored[i];	
				if(duplicateHash_nbits == dado.duplicateHash_nbits && dado.randomMessage != randomMessage){
					collidingHash = md5(dado.randomMessage);
					console.log("Message 1 = " + randomMessage + "\tCorresponding Hash = " + duplicateHash);
					console.log("Message 2 = " + dado.randomMessage + "\tCorresponding Hash = " + collidingHash);
					console.log("Number Of Iterations = " + count);
					return;
				}		
			}
			
			HashesExplored.push({duplicateHash_nbits, randomMessage});
			//HashesExplored.duplicateHash_nbits.push(randomMessage);
		}
	}

	function randomString(length) {
		var text = "";
		var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
		for(var i = 0; i < length; i++) {
		    text += possible.charAt(Math.floor(Math.random() * possible.length));
		}
		return text;
	}

	cfp(5);

	</script>
  </body>
</html>
